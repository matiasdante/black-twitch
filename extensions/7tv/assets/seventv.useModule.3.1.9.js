import{l as r}from"./seventv.GearsIcon.3.1.9.js";import{f as i,r as g,a as m,ad as f,ag as M,n as h}from"./seventv.index.3.1.9.js";const o=i({modules:{}});function $(n){return o.modules[n]??null}function k(n){const e=g(null);if(o.modules[n]&&(e.value=o.modules[n]),!e.value){const a=m(o.modules,l=>{e.value=l[n],e.value&&a()})}return e}function _(n,e){o.modules[n]=i({id:n,name:e.name,enabled:!0,depends_on:e.depends_on,instance:null});const a=f(o.modules,n),l=f(a.value,"ready"),u=g(!1),c=a.value.depends_on,d=[];for(const t of c){const s=o.modules[t];s&&d.push(new Promise(v=>{const y=m(s,()=>{s.ready&&(y(),v(s))})}))}d.length>0?(r.debug(`<Module/${e.name}>`,"Waiting for modules:",c.join(", ")),Promise.all(d).then(()=>{u.value=!0,r.debug(`<Module/${e.name}>`,`All dependencies met (${d.length})`)})):u.value=!0;function p(){const t=m(u,s=>{s&&(h(()=>t()),a.value.ready=!0,r.debug(`<Module/${e.name}>`,"Ready"))},{immediate:!0})}return M(()=>o.modules[n].ready=!1),{ready:l,dependenciesMet:u,markAsReady:p}}export{k as a,_ as d,$ as g};
