import{i as me,f as U,p as ve,_ as H,x as n,l as a,m as u,e as Y,a2 as re,r as T,a as z,w as ae,J as fe,o as pe,B as A,G as Z,N as x,u as v,F as S,E as K,as as _e,D as w,an as he,K as ge,k as be,a1 as Ce,q as L,C as J,Q as Ee,R as ke,t as we,I as te,a3 as oe,M as ye,P as Ie,at as Oe}from"./seventv.index.3.1.9.js";import{a as le,o as Te,e as Se,b as Ae,f as $e}from"./seventv.index.3.1.92.js";import{u as j,_ as q,m as Me,j as Fe,A as Ve,k as ue,G as Re}from"./seventv.GearsIcon.3.1.9.js";import{u as ce,a as Le}from"./seventv.useChatEmotes.3.1.9.js";import{a as Pe,S as xe}from"./seventv.StoreSubscribeButton.3.1.9.js";import{d as de}from"./seventv.Async.3.1.9.js";import{a as De,u as Be}from"./seventv.Settings.3.1.9.js";import{d as Ue}from"./seventv.useCosmetics.3.1.9.js";import{u as je}from"./seventv.useUpdater.3.1.9.js";import{E as Ne,_ as Ke}from"./seventv.Emote.3.1.9.js";import{e as se}from"./seventv.Transform.3.1.9.js";import{D as Ge}from"./seventv.DropdownIcon.3.1.9.js";import{U as Je}from"./seventv.UiScrollable.3.1.9.js";import{U as ze}from"./seventv.UiFloating.3.1.9.js";const ne=Symbol("seventv-emote-menu-context");function W(){let c=me(ne,null);return c||(c=U({open:!1,filter:"",channelID:""}),ve(ne,c)),c}const Ze={},qe={width:"14",height:"14",viewBox:"0 0 14 14",fill:"none",xmlns:"http://www.w3.org/2000/svg"},He=u("path",{d:"M11.3733 5.68667C11.3733 6.94156 10.966 8.10077 10.2797 9.04125L13.741 12.5052C14.0827 12.8469 14.0827 13.4019 13.741 13.7437C13.3992 14.0854 12.8442 14.0854 12.5025 13.7437L9.04125 10.2797C8.10077 10.9687 6.94156 11.3733 5.68667 11.3733C2.54533 11.3733 0 8.828 0 5.68667C0 2.54533 2.54533 0 5.68667 0C8.828 0 11.3733 2.54533 11.3733 5.68667ZM5.68667 9.62359C7.86018 9.62359 9.62359 7.86018 9.62359 5.68667C9.62359 3.51316 7.86018 1.74974 5.68667 1.74974C3.51316 1.74974 1.74974 3.51316 1.74974 5.68667C1.74974 7.86018 3.51316 9.62359 5.68667 9.62359Z",fill:"currentColor"},null,-1),Qe=[He];function Xe(c,C){return n(),a("svg",qe,Qe)}const Ye=H(Ze,[["render",Xe]]),We={mounted(c,C){const{value:f}=C;f("mounted",c)},updated(c,C){const{value:f}=C;f("updated",c)},beforeUnmount(c,C){const{value:f}=C;f("unmounted",c)}},et=["collapsed","ephemeral"],tt={class:"seventv-set-header"},ot={class:"seventv-set-header-icon"},st=["src"],nt={class:"seventv-set-name"},it={key:0,class:"seventv-emote-set"},rt=["disabled","ratio","load-state","set-id","emote-id","zero-width","favorite","onClick","onKeydown"],at=Y({__name:"EmoteMenuSet",props:{es:{},ephemeral:{type:Boolean}},emits:["emote-clicked","emotes-updated"],setup(c,{expose:C,emit:f}){const d=c,y=f,{t:D,te:b}=re(),R=W(),$=T([]),P=T(),I=T(!1),_=j("ui.emote_menu.collapsed_sets"),E=j("ui.emote_menu.favorites"),h=j("ui.emote_menu.usage"),k=le("Alt"),M=T(N());function F(e){if(d.es.id==="USAGE"){const t=h.value.get(e.id)??0;return t-t*2||0}let r=se(e);return(e.flags||0)!==0&&(r-=.5),r}const B=de((e="")=>{const r=[];if(!(d.es.provider&&!d.es.emotes.length)){for(const t of d.es.emotes)e&&!t.name.toLowerCase().includes(e.toLowerCase())||r.push(t);r.sort((t,o)=>{const p=F(t),ee=F(o);return p==ee?t.name.localeCompare(o.name):p>ee?1:-1}),$.value=r,y("emotes-updated",r)}},25);function l(e,r){return e.scope==="PERSONAL"&&r.data&&r.data.state&&!r.data.state.includes("PERSONAL")}function m(e){if(!l(d.es,e)){if(k.value){E.value.has(e.id)?E.value.delete(e.id):E.value.add(e.id),E.value=new Set(E.value);return}y("emote-clicked",e)}}function g(){const e=`emote_menu.sets.${d.es.name}`;return b(e)?D(e):d.es.name}Te("Escape",()=>{R.open=!1}),z(()=>d.es.emotes,()=>{B(R.filter)}),ae(()=>{B(R.filter)});const s=U({}),O=T(!1),G=d.es.provider!=="EMOJI";let V;function Q(){V||(V=new IntersectionObserver(e=>{e.forEach(async r=>{const t=r.target.getAttribute("emote-id");if(r.isIntersecting&&!s[t]){const o=s[t]===-1;s[t]=0,G&&!o&&O.value&&await Fe(Ve(100)).toBeTruthy()}if(s[t]===0&&!r.isIntersecting){delete s[t];return}if(r.isIntersecting&&s[t]===0){s[t]=1;return}!r.isIntersecting&&s[t]>=0&&(s[t]=s[t]===1?-1:0)}),O.value=!0}),I.value=!0)}function X(e,r){if(V)for(let t=0;t<r.children.length;t++){const o=r.children.item(t);if(!o)continue;const p=o.getAttribute("emote-id");!p||s[p]||(e==="mounted"||e==="updated"?V.observe(o):V.unobserve(o))}}function N(){return _.value?_.value.has(d.es.id):!1}function i(){_.value&&(N()?(_.value.delete(d.es.id),M.value=!1):(_.value.add(d.es.id),M.value=!0),_.value=new Set(_.value))}return fe(()=>{Q()}),pe(()=>{V&&V.disconnect()}),C({containerEl:P}),(e,r)=>e.ephemeral||$.value.length?(n(),a("div",{key:0,ref_key:"containerEl",ref:P,class:"seventv-emote-set-container",collapsed:M.value,ephemeral:e.ephemeral},[u("div",tt,[u("div",ot,[e.es.owner&&e.es.owner.avatar_url?(n(),a("img",{key:0,src:e.es.owner.avatar_url},null,8,st)):(n(),A(q,{key:1,class:"logo",provider:e.es.provider},null,8,["provider"]))]),u("span",nt,Z(g()),1),u("div",{class:"seventv-set-chevron",onClick:i},[e.ephemeral?(n(),A(Me,{key:1})):(n(),A(Ge,{key:0}))])]),I.value?x((n(),a("div",it,[(n(!0),a(S,null,K($.value,t=>{var o;return n(),a("div",{key:t.id,class:"seventv-emote-container",disabled:l(e.es,t),ratio:v(se)(t),"load-state":s[t.id],"set-id":e.es.id,"emote-id":t.id,"zero-width":(t.flags||0)!==0,favorite:((o=v(E))==null?void 0:o.has(t.id))&&e.es.id!=="FAVORITE",tabindex:"0",onClick:p=>m(t),onKeydown:_e(ge(p=>m(t),["prevent"]),["enter"])},[s[t.id]?(n(),A(Ne,{key:0,emote:t,unload:!s[t.id]},null,8,["emote","unload"])):w("",!0)],40,rt)}),128))])),[[v(We),X]]):w("",!0),he(e.$slots,"default",{},void 0,!0)],8,et)):w("",!0)}}),ie=H(at,[["__scopeId","data-v-dcbf7644"]]),lt=c=>(Ee("data-v-63ab9832"),c=c(),ke(),c),ut={class:"seventv-emote-menu-tab-container"},ct={class:"seventv-promotion-personal-emotes"},dt={key:2,class:"seventv-promotion-personal-emotes"},mt=lt(()=>u("strong",null,"ALT",-1)),vt={class:"seventv-emote-menu-tab-sidebar"},ft={class:"seventv-emote-menu-sidebar-icons"},pt=["selected","onClick"],_t={class:"seventv-emote-menu-set-sidebar-icon"},ht={key:0,class:"seventv-emote-menu-emoji-group"},gt=["src"],bt={class:"seventv-emote-menu-settings-button-container"},Ct={key:0,class:"seventv-emote-menu-settings-button-update-flair"},Et=Y({__name:"EmoteMenuTab",props:{provider:{},selected:{type:Boolean}},emits:["emote-clicked","provider-visible","toggle-settings","toggle-native-menu"],setup(c,{emit:C}){var N;const f=c,d=C,{t:y}=re(),D=W(),b=ce(D.channelID),R=Le(b),$=je(),P=T(""),I=R.byProvider(f.provider)??U({}),_=ue(),E=Ue(((N=_.identity)==null?void 0:N.id)??""),h=De(),k=U(new Set),M=T([]),F=j("ui.emote_menu.favorites"),B=["1f603","1f44b","1f343","1f354","26bd","1f698","1f4a1","1f523","1f6a9"],l=["Smileys & Emotion","People & Body","Animals & Nature","Food & Drink","Activities","Travel & Places","Objects","Symbols","Flags"],m={id:"personal-ad",name:"Personal Emotes",emotes:[]};function g(){return F.value?Array.from(F.value.values()).map(i=>R.find(e=>e.id===i)).filter(i=>!!i):[]}if(f.provider==="FAVORITE"){const i=I.FAVORITE=U({id:"FAVORITE",name:y("emote_menu.favorite_set"),emotes:g()});z(F,()=>{i.emotes=g()})}function s(){return f.provider==="FAVORITE"&&I.FAVORITE.emotes.length>0}function O(i,e){if(!e||!e.length)return;const r=e[0];r.containerEl&&(P.value=i,r.containerEl.scrollIntoView({behavior:"auto"}))}function G(i){return i.scope==="GLOBAL"?1:b.id&&i.owner&&i.owner.id===b.id?-1:(i.flags??0)&4?-2:0}function V(i,e){const r=G(i),t=G(e);return i.provider==="EMOJI"&&e.provider==="EMOJI"&&l.indexOf(i.name)>-1&&l.indexOf(e.name)>-1?l.indexOf(i.name)-l.indexOf(e.name):r==t?i.name.localeCompare(e.name):r>t?1:-1}function Q(i,e){e?k.add(i.id):k.delete(i.id),d("provider-visible",!!k.size)}const X=de(()=>{var e;const i=Object.values(I);if((e=E.emoteSets)!=null&&e.size&&i.push(...Array.from(E.emoteSets.values()).filter(r=>r.provider===f.provider)),f.provider==="PLATFORM"){const r=i.reduce((t,o)=>{const p=t[o.name];return p?p.emotes.push(...o.emotes):t[o.name]={set:o,emotes:[...o.emotes]},t},{});i.splice(0,i.length,...Object.values(r).map(t=>({...t.set,emotes:t.emotes})))}i.sort(V),M.value=i},50);return z(()=>[D.filter,I,E.emoteSets],X,{immediate:!0}),(i,e)=>{const r=be("i18n-t"),t=Ce("t");return n(),a("div",ut,[L(Je,null,{default:J(()=>[i.provider==="PLATFORM"?(n(),a("div",{key:0,class:"seventv-native-menu-toggle",onClick:e[0]||(e[0]=o=>d("toggle-native-menu"))},[L(q,{provider:"PLATFORM"}),x(u("span",null,null,512),[[t,"emote_menu.native"]])])):w("",!0),i.provider==="7TV"&&!v(h).sub?(n(),A(ie,{key:1,es:m,ephemeral:!0},{default:J(()=>[u("div",ct,[u("div",null,[x(u("p",null,null,512),[[t,"emote_menu.personal_emotes_promo_1"]]),u("span",null,Z(v(y)("emote_menu.personal_emotes_promo_2",{PLATFORM:v(_).platform.charAt(0)+v(_).platform.slice(1).toLowerCase()})),1)]),L(Pe)])]),_:1})):w("",!0),i.provider==="FAVORITE"&&!s()?(n(),a("div",dt,[u("div",null,[x(u("p",null,null,512),[[t,"emote_menu.favorite_emotes_hint_1"]]),L(r,{keypath:"emote_menu.favorite_emotes_hint_2",tag:"span"},{HOTKEY:J(()=>[mt]),_:1})])])):w("",!0),(n(!0),a(S,null,K(M.value,o=>(n(),a(S,{key:o.id},[o.emotes.length?(n(),A(ie,{key:0,ref_for:!0,ref:"es-"+o.id,es:o,onEmoteClicked:e[1]||(e[1]=p=>d("emote-clicked",p)),onEmotesUpdated:p=>Q(o,!!p.length)},null,8,["es","onEmotesUpdated"])):w("",!0)],64))),128))]),_:1}),u("div",vt,[u("div",ft,[(n(!0),a(S,null,K(M.value,o=>(n(),a(S,{key:o.id},[o.emotes.length?(n(),a("div",{key:0,class:"seventv-emote-menu-set-sidebar-icon-container",selected:P.value==o.id,onClick:p=>O(o.id,i.$refs["es-"+o.id])},[u("div",_t,[o.provider==="EMOJI"&&l.indexOf(o.name)>-1?(n(),a("div",ht,[L(Ke,{id:B[l.indexOf(o.name)],alt:o.name},null,8,["id","alt"])])):o.owner&&o.owner.avatar_url?(n(),a("img",{key:1,src:o.owner.avatar_url},null,8,gt)):(n(),A(q,{key:2,class:"logo",provider:o.provider},null,8,["provider"]))])],8,pt)):w("",!0)],64))),128))]),u("div",bt,[u("div",{class:"seventv-emote-menu-settings-button",onClick:e[2]||(e[2]=o=>d("toggle-settings"))},[L(Re,{provider:"7TV"}),v($).isUpToDate?w("",!0):(n(),a("div",Ct))])])])])}}}),kt=H(Et,[["__scopeId","data-v-63ab9832"]]),wt={class:"seventv-emote-menu-providers"},yt=["selected","onClick"],It={key:0,class:"seventv-emote-menu-search"},Ot={class:"search-icon"},Tt=Y({__name:"EmoteMenu",props:{anchorEl:{},width:{},scale:{}},emits:["emote-click","toggle-native-menu","close"],setup(c,{emit:C}){const f=c,d=C,y=T(),D=ce(),b=W();z(()=>D.id,l=>{b.channelID=l},{immediate:!0});const R=Be(),{providers:$,platform:P}=ue(),I=T(),_=j("ui.emote_menu_search"),E=j("ui.emote_menu.default_tab","7TV"),h=T(E.value),k=U({FAVORITE:!0,"7TV":$.has("7TV"),FFZ:$.has("FFZ"),BTTV:$.has("BTTV"),PLATFORM:!0,EMOJI:!0});ae(()=>{y.value&&(y.value.style.setProperty("--width",f.width??"unset"),y.value.style.setProperty("--seventv-emote-menu-scale",f.scale??"3rem"),I.value&&I.value.focus())});const M=le("Control",{initial:!1});Se("e",l=>{M.value&&(F(),l.preventDefault())}),Ae("keydown",l=>{if(l.isComposing||!["ArrowUp","ArrowDown"].includes(l.key))return;const m=Object.keys(k).indexOf(h.value??"7TV"),g=l.key==="ArrowUp"?m+1:m-1,s=Object.keys(k)[g];s&&(h.value=s)});function F(){b.open=!b.open}function B(l,m){var g;k[l]=m,!m&&l===h.value&&(h.value=((g=Object.entries(k).slice(1).find(([,s])=>s))==null?void 0:g[0])??"7TV")}return $e(y,l=>{d("close",l)}),(l,m)=>(n(),A(ze,{anchor:l.anchorEl,placement:"top-end",middleware:[v(Ie)({padding:4,mainAxis:!0,crossAxis:!0}),v(Oe)({mainAxis:4,crossAxis:-4})]},{default:J(()=>[v(b).open&&v(b).channelID?(n(),a("div",{key:0,ref_key:"containerRef",ref:y,class:"seventv-emote-menu"},[u("div",{class:we(["seventv-emote-menu-header",{"disabled-search-input":v(_)}])},[u("div",wt,[(n(!0),a(S,null,K(k,(g,s)=>(n(),a(S,null,[g||s===h.value?(n(),a("div",{key:s,class:"seventv-emote-menu-provider-icon",selected:s===h.value,onClick:O=>h.value=s},[s!=="FAVORITE"?(n(),A(q,{key:0,provider:s},null,8,["provider"])):(n(),A(xe,{key:1})),x(u("span",null,[s==="PLATFORM"?(n(),a(S,{key:0},[te(Z(v(P)),1)],64)):(n(),a(S,{key:1},[te(Z(s),1)],64))],512),[[oe,s===h.value]])],8,yt)):w("",!0)],64))),256))]),v(_)?w("",!0):(n(),a("div",It,[x(u("input",{ref_key:"searchInputRef",ref:I,"onUpdate:modelValue":m[0]||(m[0]=g=>v(b).filter=g),class:"seventv-emote-menu-search-input",autofocus:""},null,512),[[ye,v(b).filter]]),u("div",Ot,[L(Ye)])]))],2),(n(!0),a(S,null,K(k,(g,s)=>x((n(),a("div",{key:s,class:"seventv-emote-menu-body"},[L(kt,{provider:s,selected:s===h.value,onEmoteClicked:m[1]||(m[1]=O=>d("emote-click",O)),onProviderVisible:O=>B(s,O),onToggleSettings:m[2]||(m[2]=O=>v(R).toggle()),onToggleNativeMenu:m[3]||(m[3]=O=>[F(),d("toggle-native-menu")])},null,8,["provider","selected","onProviderVisible"])])),[[oe,s===h.value]])),128))],512)):w("",!0)]),_:1},8,["anchor","middleware"]))}}),Nt=H(Tt,[["__scopeId","data-v-4c6dc29f"]]);export{Nt as E,W as u};
