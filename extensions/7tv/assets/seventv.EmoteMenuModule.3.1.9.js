import{l as E}from"./seventv.GearsIcon.3.1.9.js";import{a as v}from"./seventv.Transform.3.1.9.js";import{u as M,a as k}from"./seventv.useChatEmotes.3.1.9.js";import{d as C,a as g}from"./seventv.useModule.3.1.9.js";import{e as _,r as x,a as h,ag as y,x as m,l as T,B as d,m as b,q as S,L as w,u as l,Y as B,D as P,F as A,_ as F}from"./seventv.index.3.1.9.js";import{u as L,E as O}from"./seventv.EmoteMenu.3.1.9.js";const V=_({__name:"EmoteMenu",props:{container:{},onPickEmote:{type:[Function,null]}},setup(f){const c=f,n=L(),a=x(null),r=document.createElement("seventv-container");function p(t){var e;t.target instanceof HTMLElement&&((e=a.value)!=null&&e.contains(t.target)||r.contains(t.target)||(n.open=!1))}h(()=>c.container,async t=>{if(a.value=document.querySelector("#channel-chatroom > div > div:has(#chat-input-wrapper)")??null,!t&&n.open&&(n.open=!1),!t)return;const e=t.querySelector("div:has(> .editor-input)");e?e.after(r):t.lastElementChild?t.lastElementChild.insertAdjacentElement("beforebegin",r):t.appendChild(r)},{immediate:!0});function s(t){var e;(e=c.onPickEmote)==null||e.call(c,t)}return y(()=>{r.remove()}),(t,e)=>(m(),T(A,null,[(m(),d(B,{to:l(r)},[b("button",{ref:"emoteMenuButton",class:"seventv-emote-menu-button",onClick:e[0]||(e[0]=o=>l(n).open=!l(n).open)},[S(w,{provider:"7TV",class:"icon"})],512)],8,["to"])),l(n).open&&a.value?(m(),d(O,{key:0,"anchor-el":a.value,width:"20rem",scale:"0.62rem",onEmoteClick:e[1]||(e[1]=o=>s(o)),onClose:p},null,8,["anchor-el"])):P("",!0)],64))}}),j=F(V,[["__scopeId","data-v-1e111596"]]),R=_({__name:"EmoteMenuModule",setup(f){const{markAsReady:c}=C("emote-menu",{name:"Emote Menu",depends_on:[]}),n=g("chat-input"),a=M(),r=k(a);function p(s){var t,e,o,u;s.provider==="EMOJI"?(e=(t=n==null?void 0:n.value)==null?void 0:t.instance)==null||e.appendText(s.unicode??s.name):(u=(o=n==null?void 0:n.value)==null?void 0:o.instance)==null||u.appendText(s.name)}return h(()=>a.id,async(s,t)=>{var u;if(s===t)return;const e=await fetch(`https://kick.com/emotes/${a.username}`).catch(i=>{E.error("failed to fetch channel emote data",i)});if(!e)throw new Error("failed to fetch channel emote data");const o=await e.json();for(const i of o)(u=r.providers).PLATFORM??(u.PLATFORM={}),!("user"in i&&i.user_id.toString()==a.id)&&(r.providers.PLATFORM[i.id]=v(i))}),c(),(s,t)=>{var e,o;return m(),d(j,{container:((o=(e=l(n))==null?void 0:e.instance)==null?void 0:o.container)??null,"on-pick-emote":p},null,8,["container"])}}}),H=Object.freeze(Object.defineProperty({__proto__:null,default:R},Symbol.toStringTag,{value:"Module"}));export{H as _};
