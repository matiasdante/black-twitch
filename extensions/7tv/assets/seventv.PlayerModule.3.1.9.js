import{e as R,h as B,u as $}from"./seventv.ReactHooks.3.1.9.js";import{d as I}from"./seventv.useModule.3.1.9.js";import{y as E,l as A,u as C,x as M,v as O,o as x,d as b}from"./seventv.GearsIcon.3.1.9.js";import{d as H}from"./seventv.Async.3.1.9.js";import{e as g,r as h,a as P,w as T,ag as z,u as y,x as p,l as m,E as L,B as S,F as k,D as V,_ as w,m as c,G as f,Q as D,R as G,f as N,J as W,q as F,Y as j,aG as q}from"./seventv.index.3.1.9.js";const U=g({__name:"PlayerContentWarning",props:{inst:{}},setup(l){return E(l.inst.component,"props",{value(a){var t,r;const s=(r=(t=a.children)==null?void 0:t.props)==null?void 0:r.onAcknowledge;typeof s=="function"&&(s(),A.info("<Player>","Acknowledged content warning",`(${a.restriction})`))}}),(a,s)=>null}}),J=g({__name:"PlayerController",props:{inst:{},mediaPlayer:{}},setup(l){const e=l,a=C("player.skip_content_restriction"),s=C("player.action_onclick"),t=h(null),r=h(null),i=H(()=>{t.value&&R(t.value),t.value=B({parentSelector:".seventv-player",predicate:n=>n.props&&typeof n.props.restrictions=="object"&&typeof n.props.liftRestriction=="function"})},100);P(a,n=>{n&&i()},{immediate:!0}),T(()=>{var n;if((n=e.inst.component)!=null&&n.props){if(e.inst.component.props.containerRef instanceof HTMLDivElement){const o=e.inst.component.props.containerRef;o&&o.classList.toggle("seventv-player-hide-content-warning",a.value),e.inst.component.props.containerRef.classList.add("seventv-player")}if(e.mediaPlayer){const o=e.mediaPlayer.core.mediaSinkManager.video;if(!o||!o.nextElementSibling||(r.value=o.nextElementSibling.querySelector("div[data-a-target='player-overlay-click-handler']"),!r.value))return;s.value===1?M(r.value,"PlayerActionOnClick","click",_):s.value===2?M(r.value,"PlayerActionOnClick","click",d):O(r.value,"PlayerActionOnClick","click")}}});function _(){e.mediaPlayer&&(e.mediaPlayer.isPaused()?e.mediaPlayer.play():e.mediaPlayer.pause())}function d(){e.mediaPlayer&&e.mediaPlayer.setMuted(!e.mediaPlayer.isMuted())}function v(){e.mediaPlayer}return P(s,v),z(()=>{t.value&&R(t.value),x(e.inst.component.props.mediaPlayerInstance.core.state,"liveLatency"),x(e.inst.component,"props"),r.value&&O(r.value,"PlayerActionOnClick","click")}),(n,o)=>y(a)&&t.value?(p(!0),m(k,{key:0},L(t.value.instances,u=>(p(),S(U,{key:u.identifier,inst:u},null,8,["inst"]))),128)):V("",!0)}}),Q={},Y={xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 512 512",fill:"currentColor",height:"1em",width:"1em"},K=c("path",{d:"M52.5 440.6c-9.5 7.9-22.8 9.7-34.1 4.4S0 428.4 0 416V96C0 83.6 7.2 72.3 18.4 67s24.5-3.6 34.1 4.4L224 214.3V256v41.7L52.5 440.6zM256 352V256 128 96c0-12.4 7.2-23.7 18.4-29s24.5-3.6 34.1 4.4l192 160c7.3 6.1 11.5 15.1 11.5 24.6s-4.2 18.5-11.5 24.6l-192 160c-9.5 7.9-22.8 9.7-34.1 4.4s-18.4-16.6-18.4-29V352z"},null,-1),X=[K];function Z(l,e){return p(),m("svg",Y,X)}const ee=w(Q,[["render",Z]]),te={},ae={xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 512 512",fill:"currentColor",height:"1em",width:"1em"},ne=c("path",{d:"M0 256a256 256 0 1 1 512 0A256 256 0 1 1 0 256zm320 96c0-26.9-16.5-49.9-40-59.3V88 64H232V88 292.7c-23.5 9.5-40 32.5-40 59.3c0 35.3 28.7 64 64 64s64-28.7 64-64zM144 176a32 32 0 1 0 0-64 32 32 0 1 0 0 64zm-16 80a32 32 0 1 0 -64 0 32 32 0 1 0 64 0zm288 32a32 32 0 1 0 0-64 32 32 0 1 0 0 64zM400 144a32 32 0 1 0 -64 0 32 32 0 1 0 64 0z"},null,-1),oe=[ne];function re(l,e){return p(),m("svg",ae,oe)}const se=w(te,[["render",re]]),ie=l=>(D("data-v-fa648ba1"),l=l(),G(),l),le={class:"seventv-tooltip","tooltip-type":"video-stats"},ce={class:"details"},pe=ie(()=>c("div",{class:"tooltip-title"},[c("p",null,"Stream Latency")],-1)),de=g({__name:"PlayerStatsTooltip",props:{bitrate:{},playbackRate:{},droppedFrames:{},height:{},width:{},framerate:{},bufferSize:{}},setup(l){const e=l;return(a,s)=>(p(),m("div",le,[c("div",ce,[c("p",null,"Video: "+f(e.width)+"x"+f(e.height),1),c("p",null,"Framerate: "+f(e.framerate),1),c("p",null,"Bitrate: "+f(e.bitrate)+" kbps",1),c("p",null,"Dropped Frames: "+f(e.droppedFrames),1),c("p",null,"Playback Rate: "+f(e.playbackRate.toFixed(2))+"x",1),c("p",null,"Buffer Size: "+f(e.bufferSize.toFixed(2))+"s",1)]),pe]))}}),ue=w(de,[["__scopeId","data-v-fa648ba1"]]),me={key:0},fe={key:1},ye=g({__name:"PlayerStreamInfo",props:{advancedControls:{},mediaPlayer:{}},setup(l,{expose:e}){const a=l,s=h("-.--"),t=N({droppedFrames:0,playbackRate:0,bitrate:"0",width:0,height:0,framerate:0,bufferSize:0}),r=document.createElement("seventv-container"),i=h(),_=q(ue,t);function d(){const n=a.advancedControls.component,o=document.querySelector("[data-a-target='player-overlay-video-stats']");n.setStatsOverlay(o?0:1)}function v(){var o,u;const n=(o=document.querySelector("span.live-time"))==null?void 0:o.parentElement;!n||(u=n.parentElement)!=null&&u.contains(r)||n.insertAdjacentElement("afterend",r)}return e({remount:v}),P(s,()=>{a.mediaPlayer&&(t.droppedFrames=a.mediaPlayer.getDroppedFrames(),t.bitrate=(a.mediaPlayer.getVideoBitRate()/1e3).toFixed(0)??"0",t.framerate=a.mediaPlayer.getVideoFrameRate(),t.playbackRate=a.mediaPlayer.getPlaybackRate(),t.width=a.mediaPlayer.getVideoWidth(),t.height=a.mediaPlayer.getVideoHeight(),t.bufferSize=a.mediaPlayer.getBufferDuration())},{immediate:!0}),P(()=>a.mediaPlayer,(n,o)=>{if(o&&n!==o)x(o.core.state,"liveLatency");else{if(!n)return;E(n.core.state,"liveLatency",{value:u=>{s.value=(u==null?void 0:u.toFixed(2))??"-.--"}})}},{immediate:!0}),W(()=>{v()}),z(()=>{r.remove()}),(n,o)=>(p(),S(j,{to:y(r)},[c("div",{ref_key:"videoStatsRef",ref:i,class:"seventv-video-stats",onClick:d,onMouseenter:o[0]||(o[0]=u=>y(_).show(i.value)),onMouseleave:o[1]||(o[1]=u=>y(_).hide())},[t.playbackRate>1?(p(),m("figure",me,[F(ee)])):(p(),m("figure",fe,[F(se)])),c("span",null,f(s.value)+"s",1)],544)],8,["to"]))}}),_e=w(ye,[["__scopeId","data-v-85ff8030"]]),ve=[b("player.skip_content_restriction","TOGGLE",{label:"Skip Content Warnings",hint:"Automatically skip the 'intended for mature audiences' dialog on some streams",path:["Player",""],defaultValue:!1}),b("player.video_stats","TOGGLE",{path:["Player",""],label:"Video Stats",hint:"Show Latency to Broadcaster with a tooltip of other video stats",defaultValue:!1}),b("player.action_onclick","DROPDOWN",{path:["Player",""],label:"Action on Click",hint:"Choose an action to perform when clicking on the video player. (This setting may not work in channels with extensions shown)",options:[["None",0],["Pause/Unpause",1],["Mute/Unmute",2]],defaultValue:0})],he=g({__name:"PlayerModule",setup(l){I("player",{name:"Player",depends_on:[]});const e=h(),a=C("player.video_stats"),s=h(null),t=$({parentSelector:".persistent-player",predicate:i=>i.props&&i.props.containerRef&&i.props.mediaPlayerInstance},{hooks:{render(i,_){var d,v;return e.value=i.component.props.mediaPlayerInstance,(v=(d=s.value)==null?void 0:d.remount)==null||v.call(d),_}}}),r=$({parentSelector:".persistent-player",predicate:i=>i.props&&i.setStatsOverlay&&i.setShowControls});return(i,_)=>(p(),m(k,null,[(p(!0),m(k,null,L(y(t).instances,d=>(p(),S(J,{key:d.identifier,inst:d,"media-player":e.value},null,8,["inst","media-player"]))),128)),y(r).instances.length>0?(p(),m(k,{key:0},[y(a)?(p(),S(_e,{key:0,ref_key:"info",ref:s,"advanced-controls":y(r).instances[0],"media-player":e.value},null,8,["advanced-controls","media-player"])):V("",!0)],64)):V("",!0)],64))}}),be=Object.freeze(Object.defineProperty({__proto__:null,config:ve,default:he},Symbol.toStringTag,{value:"Module"}));export{be as _};
