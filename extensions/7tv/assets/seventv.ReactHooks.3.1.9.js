var D=Object.defineProperty;var H=(t,e,o)=>e in t?D(t,e,{enumerable:!0,configurable:!0,writable:!0,value:o}):t[e]=o;var S=(t,e,o)=>(H(t,typeof e!="symbol"?e+"":e,o),o);import{O as g}from"./seventv.Async.3.1.9.js";import{o as p,p as h,y as O}from"./seventv.GearsIcon.3.1.9.js";import{ag as w,f as N}from"./seventv.index.3.1.9.js";const P="#root",T=Symbol.for("react.element"),b=Symbol.for("seventv.react.wrapper");function _(){var e;const t=document.querySelector(P);if(t){for(const o in t)if(o.startsWith("_reactRootContainer")||o.startsWith("__reactContainer$")){const n=Reflect.get(t,o);return((e=n==null?void 0:n._internalRoot)==null?void 0:e.current)??n}}}function B(t){for(const e in t)if(e.startsWith("__reactProps"))return Reflect.get(t,e)}function U(t,e,o=350,n=1/0){const s=[];let c=t,u=0;for(;c&&s.length<n&&u<=o;){if(c.stateNode&&!(c.stateNode instanceof Element)){const a=c.stateNode;e(a)&&s.push(a)}c=c.return,u++}return s}function R(t,e,o=350,n=1/0){const s=[];let c=t;const u=[];for(;!(s.length>=n);){if(!c||u.length>o){const a=u.pop();if(a){c=a.sibling;continue}else break}if(c.stateNode&&!(c.stateNode instanceof Element)){const a=c.stateNode;e(a)&&s.push(a)}u.push(c),c=c.child}return s}function y(t){for(const e in t)if(e.startsWith("__reactInternalInstance$")||e.startsWith("__reactFiber$"))return Reflect.get(t,e)}function W(t){const e=new Set;if(t.parentSelector)document.querySelectorAll(t.parentSelector).forEach(o=>{const n=y(o);n&&R(n,t.predicate,t.maxDepth).forEach(s=>e.add(s))});else if(t.childSelector)document.querySelectorAll(t.childSelector).forEach(o=>{const n=y(o);n&&U(n,t.predicate,t.maxDepth).forEach(s=>e.add(s))});else{const o=_();o&&R(o,t.predicate,t.maxDepth).forEach(n=>e.add(n))}return e.size<1?new g((o,n)=>{for(const s of o)s.addedNodes.forEach(c=>{if(c instanceof Element)if(!t.parentSelector||c.matches(t.parentSelector)){const u=y(c);u&&R(u,t.predicate,t.maxDepth).forEach(a=>e.add(a))}else c.querySelectorAll(t.parentSelector).forEach(u=>{const a=y(u);a&&R(a,t.predicate,t.maxDepth).forEach(k=>e.add(k))})});e.size>0&&n(e)},document,{subtree:!0,childList:!0}):Promise.resolve(e)}function A(t,e={}){const n=N({cls:void 0,instances:[],unhooked:!1,retry:()=>s()}),s=()=>{n.watcher&&(n.watcher.disconnect(),n.watcher=void 0);const c=W(t);c instanceof g&&(n.watcher=c),c.then(u=>{if(n.unhooked)return;n.watcher=void 0;const[a]=u;if(!a)return;const k=a.constructor;if(!k)return;n.cls=k;const m=k.prototype,E=function(r){let i=Reflect.get(r,b);return i||(i=new L(r),Reflect.set(r,b,i),n.instances.push(i)),i};if(h(m,"componentDidMount",function(r,...i){var f,d;const l=E(this);return(d=(f=e.hooks)==null?void 0:f.mount)==null||d.call(f,l),r==null?void 0:r.apply(this,i)}),h(m,"componentDidUpdate",function(r,...i){var f,d;const l=E(this);return(d=(f=e.hooks)==null?void 0:f.update)==null||d.call(f,l),r==null?void 0:r.apply(this,i)}),h(m,"componentWillUnmount",function(r,...i){var f,d;const l=Reflect.get(this,b);if(l){const v=n.instances.findIndex(x=>x.identifier===l.identifier);v>-1&&n.instances.splice(v,1),Reflect.deleteProperty(this,b),(d=(f=e.hooks)==null?void 0:f.unmount)==null||d.call(f,l)}return r==null?void 0:r.apply(this,i)}),h(m,"render",function(r,...i){var d;const l=E(this);let f=e.replaceContents?null:r==null?void 0:r.apply(this,i);return(d=e.hooks)!=null&&d.render&&(f=e.hooks.render(l,f)),e.trackRoot&&(f=M(l,"root",f,e.containerClass)),f}),h(m,"shouldComponentUpdate",function(r,...i){var f;const l=E(this);return(f=e.hooks)!=null&&f.shouldUpdate?e.hooks.shouldUpdate(l):e.replaceContents?!1:(r==null?void 0:r.apply(this,i))??!0}),e.functionHooks)for(const[r,i]of Object.entries(e.functionHooks)){h(m,r,i);for(const l of u)h(l,r,i)}for(const r of u)r.forceUpdate()},()=>{})};return s(),n}function F(t){if(t.watcher&&t.watcher.disconnect(),t.cls){const e=t.cls.prototype;p(e,"componentDidMount"),p(e,"componentDidUpdate"),p(e,"componentWillUnmount"),p(e,"render"),p(e,"shouldComponentUpdate")}for(const e of t.instances)e.component.forceUpdate();t.cls=void 0,t.instances.length=0,t.watcher=void 0,t.unhooked=!0}function I(t,e){const o={current:null};return O(o,"current",{value:n=>{n==null?delete t.domNodes[e]:t.domNodes[e]=n}}),o}function M(t,e,o,n){return{$$typeof:T,key:null,ref:I(t,e),type:"seventv-container",props:{children:o??null,class:n}}}function G(t,e){const o=A(t,e);return w(()=>{if(e!=null&&e.functionHooks)for(const n of Object.keys(e.functionHooks)){o.cls&&p(o.cls.prototype,n);for(const s of o.instances)p(s.component,n)}F(o)}),o}function C(t){let e;if(t.parentSelector||t.childSelector){const n=document.querySelector(t.parentSelector||t.childSelector);if(!n)return;e=y(n)}else e=_();const o=(t==null?void 0:t.maxDepth)??20;for(let n=0;n<o;n++){const s=t.parentSelector||!t.childSelector?e==null?void 0:e.child:e==null?void 0:e.return;if(!s||e!=null&&e.elementType&&t.predicate(e))break;e=s}return e}async function q(t){let e=C(t);return e||(e=await new Promise(o=>{const n=new MutationObserver(s=>{for(const c of s)c.addedNodes&&c.addedNodes.forEach(u=>{if(u instanceof Element){const a=C(t);a&&(o(a),n.disconnect())}})});n.observe(document,{childList:!0,subtree:!0})})),e}function Y(t,e){q(t).then(n=>{var s;(s=e==null?void 0:e.hooks)!=null&&s.render&&(h(n.elementType,"render",e.hooks.render),e.hooks.render.call(n.elementType,null,n.pendingProps),w(()=>{p(n.elementType,"render")}))})}class L{constructor(e){S(this,"identifier");S(this,"component");S(this,"domNodes");this.identifier=Symbol(),this.component=e,this.domNodes=N({})}}export{T as R,Y as a,y as b,W as c,M as d,F as e,U as f,B as g,A as h,G as u};
